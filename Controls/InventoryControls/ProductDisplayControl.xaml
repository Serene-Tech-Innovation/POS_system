<UserControl x:Class="POS.ProductDisplayControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:models="clr-namespace:POS.Models.Core"
             x:Name="root"
             Background="White">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <ItemsControl ItemsSource="{Binding ItemsSource, ElementName=root}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <StackPanel>
                        <TextBlock Text="{Binding CategoryName}" FontSize="18" FontWeight="Bold" Margin="10,15,10,5" />

                        <ItemsControl ItemsSource="{Binding Subcategories}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel>
                                        <TextBlock Text="{Binding SubcategoryName}" FontSize="16" FontWeight="SemiBold" Margin="10,10,10,5" />

                                        <ItemsControl ItemsSource="{Binding Products}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel Margin="5" />
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>

                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate DataType="models:Product">
                                                    <Border BorderBrush="LightGray" BorderThickness="1" Margin="5" Padding="5" Width="120">
                                                        <StackPanel>
                                                            <Image Width="80" Height="80" Stretch="UniformToFill"
                                                                   Source="{Binding ImageSource}" />
                                                            <Button Content="{Binding Name}" 
                                                                    Margin="5,10,5,0"
                                                                    Command="{Binding DataContext.AddToCartCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                    CommandParameter="{Binding}" />
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </ScrollViewer>
</UserControl>
